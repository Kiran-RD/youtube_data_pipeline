{
    "name": "dataflow1",
    "properties": {
        "type": "MappingDataFlow",
        "typeProperties": {
            "sources": [
                {
                    "dataset": {
                        "referenceName": "Json1",
                        "type": "DatasetReference"
                    },
                    "name": "source1"
                },
                {
                    "dataset": {
                        "referenceName": "DelimitedText1",
                        "type": "DatasetReference"
                    },
                    "name": "source2"
                }
            ],
            "sinks": [
                {
                    "dataset": {
                        "referenceName": "categoriesParquet",
                        "type": "DatasetReference"
                    },
                    "name": "sink1"
                },
                {
                    "dataset": {
                        "referenceName": "videosParquet",
                        "type": "DatasetReference"
                    },
                    "name": "sink2"
                },
                {
                    "dataset": {
                        "referenceName": "analyticsParquet",
                        "type": "DatasetReference"
                    },
                    "name": "sink3"
                }
            ],
            "transformations": [
                {
                    "name": "RemoveColumns1",
                    "description": "Autogenerated by data preview actions"
                },
                {
                    "name": "Flatten1"
                },
                {
                    "name": "Join1"
                },
                {
                    "name": "ModifyColumns1",
                    "description": "Autogenerated by data preview actions"
                }
            ],
            "script": "source(output(\n\t\tkind as string,\n\t\tetag as string,\n\t\titems as (kind as string, etag as string, id as string, snippet as (channelId as string, title as string, assignable as boolean))[]\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinferDriftedColumnTypes: true,\n\tignoreNoFilesFound: false,\n\tdocumentForm: 'arrayOfDocuments',\n\tbackslashEscape: true) ~> source1\nsource(output(\n\t\tvideo_id as string,\n\t\ttrending_date as string,\n\t\ttitle as string,\n\t\tchannel_title as string,\n\t\tcategory_id as integer,\n\t\tpublish_time as string,\n\t\ttags as string,\n\t\tviews as integer,\n\t\tlikes as integer,\n\t\tdislikes as integer,\n\t\tcomment_count as integer,\n\t\tthumbnail_link as string,\n\t\tcomments_disabled as boolean,\n\t\tratings_disabled as boolean,\n\t\tvideo_error_or_removed as boolean,\n\t\tdescription as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tinferDriftedColumnTypes: true,\n\tignoreNoFilesFound: false) ~> source2\nsource1 select(mapColumn(\n\t\titems\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> RemoveColumns1\nRemoveColumns1 foldDown(unroll(items, items),\n\tmapColumn(\n\t\tkind = items.kind,\n\t\tetag = items.etag,\n\t\tid = items.id,\n\t\t{snippet.channelid} = items.snippet.channelId,\n\t\t{snippet.title} = items.snippet.title,\n\t\t{snippet.assignable} = items.snippet.assignable\n\t),\n\tskipDuplicateMapInputs: false,\n\tskipDuplicateMapOutputs: false) ~> Flatten1\nsource2, ModifyColumns1 join(category_id == id,\n\tjoinType:'inner',\n\tbroadcast: 'auto')~> Join1\nFlatten1 derive(id = toInteger(id)) ~> ModifyColumns1\nModifyColumns1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink1\nsource2 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink2\nJoin1 sink(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tformat: 'parquet',\n\tumask: 0022,\n\tpreCommands: [],\n\tpostCommands: [],\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> sink3"
        }
    }
}